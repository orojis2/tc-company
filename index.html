<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<script>
  const provider = new ethers.providers.JsonRpcProvider(
    "https://polygon-mainnet.infura.io/v3/bfaa649142194441af37875d88e7b89d"
  );

  const contractAddress = "0x0f8771d2d3600b7bfd01b01aa009eea4bb9302a7";
  const abi = [
    "function checkUUID(string uuid) public view returns (string memory)"
  ];

  async function verifyUUID() {
    const uuid = document.getElementById("uuidInput").value.trim();
    const resultBox = document.getElementById("result");
    resultBox.innerText = "β³ μ²λ¦¬ μ¤‘...";

    if (!uuid) {
      resultBox.innerText = "β— UUIDλ¥Ό μ…λ ¥ν•΄μ£Όμ„Έμ”.";
      return;
    }

    try {
      const contract = new ethers.Contract(contractAddress, abi, provider);
      const result = await contract.checkUUID(uuid);

      if (result.startsWith("ALREADY VERIFIED")) {
        resultBox.innerText = `π” μ΄λ―Έ μΈμ¦λ μΉ΄λ“μ…λ‹λ‹¤.\n${result}`;
      } else if (result === "VALID") {
        resultBox.innerText = "β… μ •ν’μ…λ‹λ‹¤.";
      } else {
        resultBox.innerText = "β μ •ν’μ΄ μ•„λ‹™λ‹λ‹¤.";
      }
    } catch (err) {
      console.error(err);
      resultBox.innerText = "β οΈ μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤.";
    }
  }

  function showPopup() {
    alert(
      `ν΄λ¦¬κ³¤μ¤μΊ”(λΈ”λ΅μ²΄μΈ κ³µμ‹ν™νμ΄μ§€)μ—μ„ ν™•μΈν•λ” λ°©λ²•:\n\n1. https://polygonscan.com μ— μ ‘μ†ν•©λ‹λ‹¤.\n2. κ²€μƒ‰μ°½μ— μ•„λ μ¤λ§νΈμ»¨νΈλ™νΈ μ£Όμ†λ¥Ό λ¶™μ—¬λ„£μµλ‹λ‹¤.\n   π‘‰ 0x0f8771d2d3600b7bfd01b01aa009eea4bb9302a7\n3. Read Contract > checkUUID ν•­λ©μΌλ΅ μ΄λ™ν•©λ‹λ‹¤.\n4. UUID κ°’μ„ μ…λ ¥ν•λ©΄ λ“±λ΅ μ—¬λ¶€λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.`
    );
  }

  document.getElementById("verifyBtn").addEventListener("click", verifyUUID);
</script>
