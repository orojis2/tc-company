<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TC ì¹´ë“œ ì •í’ˆ ì¸ì¦</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f2f2f2;
      text-align: center;
      padding: 2rem;
    }
    .card {
      background-color: white;
      padding: 2rem;
      border-radius: 10px;
      max-width: 400px;
      margin: auto;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
    }
    .status {
      font-size: 1.5rem;
      margin-top: 1rem;
    }
    .info {
      margin-top: 1rem;
      font-size: 0.95rem;
      color: #555;
    }
    .footer {
      margin-top: 2rem;
      font-size: 0.85rem;
      color: #777;
    }
  </style>
</head>
<body>
  <div class="card">
    <h2>ğŸ”‘ TC ì¹´ë“œ ì •í’ˆ ì¸ì¦ ê²°ê³¼</h2>
    <div class="status" id="result">ë¡œë”© ì¤‘...</div>
    <div class="info" id="logInfo"></div>
    <div class="footer">
      <p><strong>ğŸ” ì •í’ˆ ë³´ì¦: ë¸”ë¡ì²´ì¸ ê¸°ë°˜ ì¸ì¦ ì‹œìŠ¤í…œ</strong><br/>
      ë³¸ ì¹´ë“œëŠ” ë¸”ë¡ì²´ì¸ì— ë“±ë¡ëœ ê³ ìœ  ì‹ë³„ì(UUID)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë°œê¸‰ë©ë‹ˆë‹¤.<br/>
      ì¸ì¦ì€ <strong>ìµœëŒ€ 3íšŒ</strong>ê¹Œì§€ ê°€ëŠ¥í•˜ë©°, ë³µì œ ë°©ì§€ ë° ì •í’ˆ ì¶”ì ì„ ìœ„í•´<br/>
      ì¸ì¦ ê¸°ë¡ì´ ìë™ ì €ì¥ë©ë‹ˆë‹¤.</p>
    </div>
  </div>

  <script>
    const validUUIDs = ["4AFn1TN8"];
    const MAX_ATTEMPTS = 3;

    function getQueryParam(param) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(param);
    }

    function getLogs(uuid) {
      const logKey = `authlog_${uuid}`;
      let logs = localStorage.getItem(logKey);
      return logs ? JSON.parse(logs) : [];
    }

    function addLog(uuid) {
      const logKey = `authlog_${uuid}`;
      const logs = getLogs(uuid);
      const now = new Date().toLocaleString();
      logs.push(now);
      localStorage.setItem(logKey, JSON.stringify(logs));
      return logs;
    }

    function renderResult(uuid) {
      const resultDiv = document.getElementById("result");
      const logDiv = document.getElementById("logInfo");
      const logs = getLogs(uuid);

      if (!validUUIDs.includes(uuid)) {
        resultDiv.innerHTML = `âŒ ë“±ë¡ë˜ì§€ ì•Šì€ ì¹´ë“œì…ë‹ˆë‹¤.`;
        resultDiv.style.color = "red";
        return;
      }

      if (logs.length >= MAX_ATTEMPTS) {
        resultDiv.innerHTML = `âš ï¸ ì¸ì¦ íšŸìˆ˜ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤.`;
        resultDiv.style.color = "orange";
        logDiv.innerHTML = `ì¸ì¦ ê¸°ë¡ (${MAX_ATTEMPTS}íšŒ ì´ˆê³¼):<br/>` + logs.map((t, i) => `${i+1}íšŒ: ${t}`).join("<br/>");
        return;
      }

      const updatedLogs = addLog(uuid);
      resultDiv.innerHTML = `âœ… ì •í’ˆ ì¹´ë“œì…ë‹ˆë‹¤.`;
      resultDiv.style.color = "green";
      logDiv.innerHTML = `ì¸ì¦ ê¸°ë¡ (${updatedLogs.length}/${MAX_ATTEMPTS}íšŒ):<br/>` + updatedLogs.map((t, i) => `${i+1}íšŒ: ${t}`).join("<br/>");
    }

    const uuid = getQueryParam("uuid");
    if (uuid) {
      renderResult(uuid);
    } else {
      document.getElementById("result").innerText = "âŒ ìœ íš¨í•˜ì§€ ì•Šì€ ì ‘ê·¼ì…ë‹ˆë‹¤.";
      document.getElementById("result").style.color = "red";
    }
  </script>
</body>
</html>
